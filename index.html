<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Office Lunch</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

  <style>
    body { font-family: Arial; background:#f4f6f8; padding:16px; text-align:center; }
    .card { background:#fff; padding:16px; border-radius:10px; margin-bottom:16px; }
    canvas { margin-top:10px; border:4px solid #2e7d32; border-radius:8px; }
    button { width:100%; padding:14px; margin-top:10px; font-size:16px; border-radius:8px; border:none; color:#fff; }
    .green { background:#2e7d32; }
    .orange { background:#ef6c00; }
    .grey { background:#607d8b; }
    input { width:100%; padding:12px; margin-top:10px; }
  </style>
</head>

<body>

<div class="card">
  <h3>üçΩ Today‚Äôs Lunch</h3>
  <div id="menu">Loading...</div>
  <h3>Amount: ‚Çπ<span id="price">--</span></h3>

  <h4>üü¢ Scan QR (Recommended)</h4>
  <canvas id="upiQR"></canvas>

  <h4>üü° Pay via UPI App (‚â§ ‚Çπ2000)</h4>
  <button class="orange" onclick="payViaUPI()">Pay Now</button>
</div>

<div class="card">
  <h3>üßæ Confirm Lunch</h3>
  <input id="name" placeholder="Your Name">
  <input id="txn" placeholder="Last 4 digits of Txn ID" maxlength="4">
  <button class="grey" onclick="confirm()">Confirm Lunch</button>
</div>

<script>
const MENU_API = "https://script.google.com/macros/s/AKfycbw7i5g_xmX59blWHM0On-r8cspalpQhKdMp67HrrdesqnIXywyOrSwwBJUGk04mnRXWJg/exec";
const TRACKER_API = "https://script.google.com/macros/s/AKfycbx0RZAO9Z2xHmvIKduWQ6t_Z0aN_9ttwsus_9eU5NedrDoFXiMD8Xm09maI9265N6Vz3w/exec";
const UPI_ID = "ss8001082@okaxis";
const VENDOR = "Sasi S";
let amt = "";

fetch(MENU_API)
.then(r=>r.json())
.then(d=>{
  document.getElementById("menu").innerText = d.menu;
  document.getElementById("price").innerText = d.price;
  amt = d.price;
  genQR();
});

function genQR(){
  const ref="LUNCH"+Date.now();
  new QRious({
    element:document.getElementById("upiQR"),
    value:`upi://pay?pa=${UPI_ID}&pn=${VENDOR}&am=${amt}&cu=INR&tn=Office Lunch&tr=${ref}`,
    size:220
  });
}

function payViaUPI(){
  window.location.href=`upi://pay?pa=${UPI_ID}&pn=${VENDOR}&am=${amt}&cu=INR`;
}

function confirm(){
  fetch(TRACKER_API,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      name:name.value,
      txnLast4:txn.value
    })
  }).then(r=>r.json())
   .then(()=>alert("Lunch Confirmed"))
   .catch(()=>alert("Network error"));
}
</script>

</body>
</html>

